// Test Add to Cart UI functionality
try {
    System.debug('üß™ Testing Add to Cart UI functionality...');
    
    // Test 1: addToCart method response structure
    System.debug('üß™ Test 1: addToCart method response structure');
    try {
        // Get a test product
        List<Product2> testProducts = [
            SELECT Id, Name, ProductCode 
            FROM Product2 
            WHERE IsActive = true 
            LIMIT 1
        ];
        
        if (!testProducts.isEmpty()) {
            Product2 testProduct = testProducts[0];
            System.debug('üîÑ Testing with product: ' + testProduct.Name);
            
                    // Test addProductToShoppingCart method
        String productId = String.valueOf(testProduct.Id);
        Object result = ENOS_ProductController.addProductToShoppingCart(productId, 1);
            
            System.debug('‚úÖ addToCart result: ' + result);
            
            // Check the result structure
            if (result != null) {
                System.debug('üìä Result: ' + result);
                
                // Check if it's a CartItemResult
                if (result instanceof ENOS_ProductController.CartItemResult) {
                    ENOS_ProductController.CartItemResult cartResult = (ENOS_ProductController.CartItemResult) result;
                    
                    System.debug('üéØ CartItemResult structure:');
                    System.debug('  success: ' + cartResult.success);
                    System.debug('  message: ' + cartResult.message);
                    System.debug('  cartItem: ' + cartResult.cartItem);
                    
                    if (cartResult.success) {
                        System.debug('üéâ SUCCESS: Item added to cart!');
                        System.debug('  Message: ' + cartResult.message);
                        if (cartResult.cartItem != null) {
                            System.debug('  Cart Item ID: ' + cartResult.cartItem.Id);
                            System.debug('  Quantity: ' + cartResult.cartItem.Quantity__c);
                        }
                    } else {
                        System.debug('‚ùå FAILED: ' + cartResult.message);
                    }
                } else {
                    System.debug('‚ö†Ô∏è Result is not a CartItemResult: ' + result);
                }
            }
            
        } else {
            System.debug('‚ùå No test products available');
        }
        
    } catch (Exception e) {
        System.debug('‚ùå addToCart test failed: ' + e.getMessage());
        System.debug('Stack trace: ' + e.getStackTraceString());
    }
    
    // Test 2: Check current cart status
    System.debug('üß™ Test 2: Check current cart status');
    try {
        String currentUserId = UserInfo.getUserId();
        List<Cart__c> userCarts = [
            SELECT Id, Status__c, OwnerId, Subtotal__c
            FROM Cart__c 
            WHERE OwnerId = :currentUserId 
            AND Status__c = 'Active'
            ORDER BY CreatedDate DESC
            LIMIT 1
        ];
        
        if (!userCarts.isEmpty()) {
            Cart__c userCart = userCarts[0];
            System.debug('‚úÖ User has active cart: ' + userCart.Id);
            
            // Check cart items
            List<Cart_Item__c> cartItems = [
                SELECT Id, Product__c, Quantity__c, Unit_Price__c, Line_Total__c
                FROM Cart_Item__c
                WHERE Cart__c = :userCart.Id
            ];
            
            System.debug('‚úÖ Cart contains ' + cartItems.size() + ' items');
            for (Cart_Item__c item : cartItems) {
                System.debug('  Item: Product=' + item.Product__c + ', Qty=' + item.Quantity__c);
            }
            
        } else {
            System.debug('‚ùå User has no active cart');
        }
        
    } catch (Exception e) {
        System.debug('‚ùå Cart status check failed: ' + e.getMessage());
    }
    
    System.debug('üéâ Add to Cart UI testing completed!');
    
} catch (Exception e) {
    System.debug('‚ùå Error during Add to Cart UI testing: ' + e.getMessage());
    System.debug('Stack trace: ' + e.getStackTraceString());
}
